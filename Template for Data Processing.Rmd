---
title: "Data Process Template-NDVI"
author: "Frankie Fan"
date: '2022-06-23'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(moderndive)
library(readr)
library(tidyr)
```
## Read in the files
```{r}
NDVI_source <- read_csv("./Data/NDVI_ts_Zimb.csv")

```

## Goal: find the mean, max and min value for precipitation for each month

1. Drop some unessential columns 
```{r}
#This is in wide format
NDVI_wide <- NDVI_source %>% 
  select(NAME_2, `2000_03_12_NDVI`:`2021_12_30_NDVI`) %>% 
  rename(District = NAME_2)
```

2. Transform it to long format
```{r}
# Parsed through the date with "_". Might need to change the code when it comes with different format
NDVI_long <- gather(NDVI_wide, Date, NDVI, `2000_03_12_NDVI`:`2021_12_30_NDVI`)%>% 
  separate( col=Date, into=c('Year', 'Month', "Day", "NDVI11"), sep='_') %>% 
  select(-NDVI11)

```

3. Find the average, max, and min precipitation for annual level
```{r}
NDVI_annual <- NDVI_long %>% 
  select(-Month, -Day) %>% 
  group_by(District, Year) %>%    # group by district and year
  summarise(AverageNDVI = mean(NDVI, na.rm=TRUE),   # Find the mean, max, min by district
         MaxNDVI = max(NDVI, na.rm=TRUE),
         MinNDVI = min(NDVI, na.rm=TRUE))

write.csv(NDVI_annual,"./Data/NDVI_annual.csv", row.names = FALSE)


```

4. Monthly Data
```{r}
NDVI_monthly <- NDVI_long %>% 
  select(-Day) %>% 
  group_by(District, Year, Month) %>%    # group by district and year
  summarise(AverageNDVI = mean(NDVI, na.rm=TRUE),   # Find the mean, max, min by district
         MaxNDVI = max(NDVI, na.rm=TRUE),
         MinNDVI = min(NDVI, na.rm=TRUE))

write.csv(NDVI_monthly,"./Data/NDVI_monthly.csv", row.names = FALSE)


```


